# Armonia多链区块链

> 支持一母链多子链的区块链技术平台

- [Armonia多链区块链](#armonia多链区块链)
  - [介绍](#介绍)
  - [目标和原则](#目标和原则)
  - [整体架构](#整体架构)
    - [多链模型](#多链模型)
    - [母链基本特征](#母链基本特征)
    - [跨链机制](#跨链机制)
  - [母链共识机制](#母链共识机制)
  - [通证经济模型](#通证经济模型)
    - [通证分配](#通证分配)
    - [万物皆挖矿](#万物皆挖矿)
  - [xDAO治理](#xdao治理)
  - [技术路线图](#技术路线图)
## 介绍
纵观区块链的发展历史，从最初实现分布式记账开始，到能支持各类复杂计算的智能合约技术，到提供区块链第零层(L0)的SDK帮助快速搭建新的区块链技术，以及建设专门的第二层网络(L2)技术来解决区块链第一层(L1)所无法完全满足的功能，还有实现各区块链之间的双向跨链技术，区块链技术变得越来越复杂，以满足愈加丰富多彩的上层应用。

除了满足区块链的安全、可靠、去中心化等特性，迄今为止并没有一个单一的区块链技术能够很好地满足以下特性：
- 高并发处理性能
- 模块化与可扩展
- 个性化与可定制
  
Armonia核心团队认为唯有建设一个多链架构的区块链技术平台才能实现以上目标，从而可以服务于全世界的每一位区块链爱好者和商业机构。Armonia核心团队也认为未来的元宇宙世界必定是一个去中心化的、开放式的多链森林体系，其中承载了用户、资产和交易等核心数据和基于智能合约的各类核心应用。

## 目标和原则
Armonia是一个子母链架构的多链技术平台，其中有安全、高性能且超低交易费用的母链(Armonia Mother Chain)，还有其它同构或者异构类的子链(Armonia Child Chain)并存，子链和母链之间，子链和子链之间的实现高效资产双向跨链，以实现支持全球至少十亿区块链用户为最终目标。

核心建设目标如下：
- 母链提供多链统一的账户体系和原生代币AMAX，为整个多链生态提供底层价值动能和信任锚定；
- 提供L0的底层SDK模版，可以快速搭建生态内多个垂直应用型区块链子链，可以和母链进行双向的、安全的无缝资产跨链；
- 子链支持同构链或者异构链，公有链、私有链或者联盟链等各类形态，且子链可以采用不同共识机制；
- 通过母链获取所注册和锚定的web3.0所需的分布式存储、网络和计算资源提供节点，并相应激励资源提供者，为建设web3.0上层应用提供全方位底层支持；
- 成为构建元宇宙的坚实底座

设计原则：
- 安全可靠：确保母链的网络共识具有较高的去中心化特性，任何作恶可以被及时发现、惩罚和修正，确保母链承载的资产的绝对安全；
- 可扩展：通过模块化建设，把区块链实现模块像乐高积木一样可组合，可替换，并可延伸；
- 高性能：不光母链具有高TPS，通过多个子链分摊不同领域或者应用的交易，这样整个多链体系可以实现全平台超高性能支撑；
- 个性化：通过定制化的子链设计，不同的子链可以具备不同的区块链特性，来满足生态内多样性的需求；

## 整体架构
Armonia作为一个多链架构的区块链技术平台，采用了子母链的特殊关系，而不是其它多链体系的星型模式，其结构如下图所示：
<img src="./assets/Armonia-Multichain-Arch.png" width=600 />

其核心设计为：
- 母链采用了特有的APoS共识机制和高性能的WASM虚拟机，采用低交易成本费用模型，和特有的账户而非地址模型
- 子链可以由平台提供的某种L0 SDK快速构建而成，可以和母链同构也可以是异构关系，
- 其他独立公链比如Bitcoin、Ethereum等也可以被包融进来，而成为多链体系里面的子链存在
- 所有子链和母链或者子链和子链之间都可以通过母链的跨链合约来完成可靠跨链
  
### 多链模型

对于采用多链平台提供的L0 SDK构建而成的子链，可以有定制化的共识模块，包括出块速度，最终确定性机制，虚拟机类型和账户地址类型等的差异。这种多样性，可定制性，可以极大的满足生态内的建设领域需求。

这类子链可以发行和拥有自己的原生代币，也可以直接采用母链的原生代币。比如说有一条子链采用了gas模型，它的gas支付可以来自于母链跨链而来的AMAX原生代币。在这种情况下，子链对AMAX的消耗也就增加了对母链原生代币的需求，因此可以为母链原生代币进行价值赋能。

我们把每一条单链模拟为字母T：其中横线代表区块链上交易和块数据，竖线代表了在某个高度上的区块链状态数据（比如说账户余额状态）同时把开放式的公链单链用虚线包围起来，表示一个开放但是单独的网络环境。把私有链通过实线包围起来，代表一个相对封闭的网络环境。其中母链可以为所有子链的生成和信任锚定基础，以及资产交易交换的平台。整体多链系统构成了如下的区块链森林体系：
<img src="./assets/Armonia-Multichain-Forest.png" title="Armonia多链森林体系" width=600 />

如果考虑到全网所有的现有区块链和Armonia多链体系的关系如下：
<img src="./assets/armonia-multichain-scope.png" title="Armonia多链和全网区块链关系" width=600 />

### 母链基本特征

| 特征 | 说明 | 备注 |
|---|---|---|
| 原生代币符号 | AMAX | 由系统合约 **amax.token** 发行|
| AMAX的精度 | 4 | 最小可分割为万分之一|
| 设计总量 | 1,000,000,000 | 没有系统性增发机制，但是可销毁或通缩机制 |
| 共识机制 | APOS | Armonia特有共识机制 |
| 虚拟机 | WASM | 高性能虚拟机 |
| 出块速度 | 1 秒 | |

### 跨链机制

在一个多链的生态体系里面，可以让链上发行的资产从原链映射到另外一条链或者反之是至关重要的。某种意义上讲，跨链增加了链上资产的流动性和可用性。同时，将一个资产从原链跨到另外一条链，也可以自由跨链回来，可以满足资产用户的在区块链生态内的全部需求。

但是要做到以上的双向、可靠、高效的跨链，需要解决跨链过程中涉及到的各类问题：
- 如何保障链上资产转移交易的最终确定性
- 如何把一条链的交易信息及时同步到另外一条链上去
- 如何确保跨链中各项交易执行内容的准确性和有效性
- 如何避免恶意用户利用跨链盗走资产
- 如何防止在映射的链上面的映射资产被恶意滥发并使用
  
同时还需要考虑的问题有：如何实现一种通用性的跨链解决方案，可以满足各种链之间的跨链需求，而不是为不同链定制不同跨链方案？

Armonia核心团队基于以上问题，提出了一种混合治理模型的且相对安全可靠的通用型跨链解决方案，具体如下：

说明：
| 名称 | 代号 | 
| ---- | ---- |
| Armonia母链 | `M` |
| 跨链资产所在原链 | `A` |
| 跨链资产映射目标链 | `B` |
| 跨链用户 | `BU` |
| 跨链服务商 | `BO` |
| 跨链目标资产 | `AS` |
| 跨链目标资产在目标链的治理组织 | `DAO` |

资产在A链上的分配已经由A链的共识机制、通证经济和生态发展决定了，跨链的资产在目标链B上面需要有相应的ERC20合约来承载，提供铸币、发行、转账和销毁等功能，并且这些功能由DAO来决定。

* 准备工作
1. 在M链上提供系统合约作为跨链的基础合约`amax.xswap`，记录和管控跨链同类资产兑换的全部过程；
2. 在A链部署部署合约作为跨链资产的托管合约`as_custody`；
3. 在B链部署ERC20合约`as_erc20`作为资产接收和销毁功能；同时也有动态铸币功能，铸币权由DAO来管控；

* 流程如下
1. BO找到DAO，申请在B链上的跨链资产，比如说100万枚AS；DAO在BO打入100万A链上的资产到`as_custody`,在B链上通过`as_erc20`合约铸币100万AS给BO；
1. BO开始通过`amax.xswap`上面挂上出售的订单，并且质押两倍价值的AMAX代币在该合约内；
1. BU通过`amax.xswap`找到自己愿意成交的订单，可以部分或者全部吃下该订单；
1. BU将AS资产从A链打入到BO的账户或者地址；同时将该交易`TxID`通知到`amax.xswap`的订单状态内；
1. BO在得到订单状态变更后将相应的AS资产在目标链B打入到BU的地址或者账户上，从而完成订单；
   
注：
1. 如果兑换订单产生纠纷，将由`DAO`来帮助完成仲裁过程，确保订单的正确执行或关闭；
2. 母链M也可能是A链或者B链之一。

流程示意图如下：

<img src="./assets/armonia-cross-bridge-cn.png" width=600 />



## 母链共识机制

作为多链森林体系的母链，担当了所有其它子链的信任基石

Armonia母链采用了一种特有的全新的共识机制：APOS （Armonia PoS)

## 通证经济模型

### 通证分配

### 万物皆挖矿

## xDAO治理

## 技术路线图

基本技术路线图如下：
- v1.0
- v2.0
- v3.0

在实现v3.0之后的技术路线图，必将由developer.dao来全面驱动和治理实现完成。